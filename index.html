<!DOCTYPE html>

<!-- By Frode Eika Sandnes, Oslo Metropolitan University, Oslo, Norway, May 2021 -->

<html>
	<head>
		<meta charset="utf-8">
		<title>LINK: Approximate linking of records</title>
		<link href="LINK.css" rel="stylesheet">
		
		<script src="LINK.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.1/xlsx.full.min.js"></script> 
	</head>
	
	<body>
		<h1>LINK: Approximate linking of records</h1>
 
		<p></p>
		<p></p>
 
		<form name="encodeform">
			<h2>Add files to link</h2>
			<ul>
				<li>
					<label for="file-selector1"><span>File 1</span></label>
					<input type="file" id="file-selector1" accept=".xlsx, .xls, .csv">
						<script>
							loadBinaryFile("1");
						</script>
				</li>
				<p id="table1" />
		<p id="messageFile1" />					
				
				<p/>
				<li>						
					<label for="file-selector2"><span>File 2</span></label>				
					<input type="file" id="file-selector2" accept=".xls, .xlsx, .csv">
					<script>
						loadBinaryFile("2");
					</script>
				</li>
				<p id="table2" />
		<p id="messageFile2" />					
			</ul>				
			<p/>	
				<button type="submit" onClick="return mergeOnFirstColumns()">Link files again</button> 				
				<button type="submit" onClick="return outputSpreadsheet()">Download linked file</button> 		
			<ul>
				<li>	
					<label for="acceptLimitId" name="acceptLabel"><span>Similarity threshold (80)</span></label>						
					<input type="range" min="1" max="100" value="80" class="slider" id="acceptLimitId" onInput="acceptChange()" onmouseup="mergeOnFirstColumns()" list="tickmarks"> 
					
					<datalist id="tickmarks">
					  <option value="0"></option>
					  <option value="50"></option>
					  <option value="70"></option>
					  <option value="80"></option>
					  <option value="90"></option>
					  <option value="100"></option>
					</datalist>
				
						
  				</li>
			</ul>				
			<p/>	

									   
			<p/>
				
		<p id="matchingId" />		

		<p/>
		
		<p id="nonmatching1Id" />

		<p id="nonmatching2Id" />
	
		<p id="duplicates1Id" />

		<p id="duplicates2Id" />

		</form>		
	</body>
</html>